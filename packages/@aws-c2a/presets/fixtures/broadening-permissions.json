[{"let":{"INSERT_COMPONENT":{"change":{"type":"INSERT"}},"INSERT_PROPERTY":{"change":{"propertyOperationType":"INSERT"}},"UPDATE_PROPERTY":{"change":{"propertyOperationType":"UPDATE"}}},"then":[{"let":{"AWSLambdaPermission":{"component":{"type":"Resource","subtype":"AWS::Lambda::Permission"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSLambdaPermission"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}}]},{"let":{"AWSIAMGroup":{"component":{"type":"Resource","subtype":"AWS::IAM::Group"}}},"then":[{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMGroup.Properties.ManagedPolicyArns.*"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMGroup","INSERT_COMPONENT.new.Properties.ManagedPolicyArns.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMGroup","INSERT_COMPONENT.new.Properties.ManagedPolicyArns.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}}]},{"let":{"AWSIAMRole":{"component":{"type":"Resource","subtype":"AWS::IAM::Role"}}},"then":[{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMRole.Properties.ManagedPolicyArns.*"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMRole","INSERT_COMPONENT.new.Properties.ManagedPolicyArns.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMRole","INSERT_COMPONENT.new.Properties.ManagedPolicyArns.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}}]},{"let":{"AWSIAMUser":{"component":{"type":"Resource","subtype":"AWS::IAM::User"}}},"then":[{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMUser.Properties.ManagedPolicyArns.*"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMUser","INSERT_COMPONENT.new.Properties.ManagedPolicyArns.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMUser","INSERT_COMPONENT.new.Properties.ManagedPolicyArns.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}}]},{"let":{"AWSIAMGroup":{"component":{"type":"Resource","subtype":"AWS::IAM::Group"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMGroup","INSERT_COMPONENT.new.Properties.Policies.*.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMGroup.Properties.Policies.*.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSIAMGroup.Properties.Policies.*.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMGroup.Properties.Policies.*","INSERT_PROPERTY.new.PolicyDocument.Statement.* == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}}]},{"let":{"AWSIAMRole":{"component":{"type":"Resource","subtype":"AWS::IAM::Role"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMRole","INSERT_COMPONENT.new.Properties.Policies.*.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMRole.Properties.Policies.*.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSIAMRole.Properties.Policies.*.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMRole.Properties.Policies.*","INSERT_PROPERTY.new.PolicyDocument.Statement.* == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}}]},{"let":{"AWSIAMUser":{"component":{"type":"Resource","subtype":"AWS::IAM::User"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMUser","INSERT_COMPONENT.new.Properties.Policies.*.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMUser.Properties.Policies.*.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSIAMUser.Properties.Policies.*.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMUser.Properties.Policies.*","INSERT_PROPERTY.new.PolicyDocument.Statement.* == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}}]},{"let":{"AWSApiGatewayRestApi":{"component":{"type":"Resource","subtype":"AWS::ApiGateway::RestApi"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSApiGatewayRestApi","INSERT_COMPONENT.new.Properties.Policy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSApiGatewayRestApi.Properties.Policy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSApiGatewayRestApi.Properties.Policy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSBackupBackupVault":{"component":{"type":"Resource","subtype":"AWS::Backup::BackupVault"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSBackupBackupVault","INSERT_COMPONENT.new.Properties.AccessPolicy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSBackupBackupVault.Properties.AccessPolicy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSBackupBackupVault.Properties.AccessPolicy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSCodeArtifactDomain":{"component":{"type":"Resource","subtype":"AWS::CodeArtifact::Domain"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSCodeArtifactDomain","INSERT_COMPONENT.new.Properties.PermissionsPolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSCodeArtifactDomain.Properties.PermissionsPolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSCodeArtifactDomain.Properties.PermissionsPolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSCodeArtifactRepository":{"component":{"type":"Resource","subtype":"AWS::CodeArtifact::Repository"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSCodeArtifactRepository","INSERT_COMPONENT.new.Properties.PermissionsPolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSCodeArtifactRepository.Properties.PermissionsPolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSCodeArtifactRepository.Properties.PermissionsPolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSEC2VPCEndpoint":{"component":{"type":"Resource","subtype":"AWS::EC2::VPCEndpoint"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSEC2VPCEndpoint","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSEC2VPCEndpoint.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSEC2VPCEndpoint.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSECRPublicRepository":{"component":{"type":"Resource","subtype":"AWS::ECR::PublicRepository"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSECRPublicRepository","INSERT_COMPONENT.new.Properties.RepositoryPolicyText.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSECRPublicRepository.Properties.RepositoryPolicyText.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSECRPublicRepository.Properties.RepositoryPolicyText.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSECRRepository":{"component":{"type":"Resource","subtype":"AWS::ECR::Repository"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSECRRepository","INSERT_COMPONENT.new.Properties.RepositoryPolicyText.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSECRRepository.Properties.RepositoryPolicyText.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSECRRepository.Properties.RepositoryPolicyText.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSEFSFileSystem":{"component":{"type":"Resource","subtype":"AWS::EFS::FileSystem"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSEFSFileSystem","INSERT_COMPONENT.new.Properties.FileSystemPolicy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSEFSFileSystem.Properties.FileSystemPolicy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSEFSFileSystem.Properties.FileSystemPolicy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSIAMRole":{"component":{"type":"Resource","subtype":"AWS::IAM::Role"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMRole","INSERT_COMPONENT.new.Properties.AssumeRolePolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMRole.Properties.AssumeRolePolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSIAMRole.Properties.AssumeRolePolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSKMSKey":{"component":{"type":"Resource","subtype":"AWS::KMS::Key"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSKMSKey","INSERT_COMPONENT.new.Properties.KeyPolicy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSKMSKey.Properties.KeyPolicy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSKMSKey.Properties.KeyPolicy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSKMSReplicaKey":{"component":{"type":"Resource","subtype":"AWS::KMS::ReplicaKey"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSKMSReplicaKey","INSERT_COMPONENT.new.Properties.KeyPolicy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSKMSReplicaKey.Properties.KeyPolicy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSKMSReplicaKey.Properties.KeyPolicy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSS3AccessPoint":{"component":{"type":"Resource","subtype":"AWS::S3::AccessPoint"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSS3AccessPoint","INSERT_COMPONENT.new.Properties.Policy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSS3AccessPoint.Properties.Policy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSS3AccessPoint.Properties.Policy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSS3OutpostsAccessPoint":{"component":{"type":"Resource","subtype":"AWS::S3Outposts::AccessPoint"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSS3OutpostsAccessPoint","INSERT_COMPONENT.new.Properties.Policy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSS3OutpostsAccessPoint.Properties.Policy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSS3OutpostsAccessPoint.Properties.Policy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSSNSSubscription":{"component":{"type":"Resource","subtype":"AWS::SNS::Subscription"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSSNSSubscription","INSERT_COMPONENT.new.Properties.RedrivePolicy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSSNSSubscription.Properties.RedrivePolicy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSSNSSubscription.Properties.RedrivePolicy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSSSOPermissionSet":{"component":{"type":"Resource","subtype":"AWS::SSO::PermissionSet"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSSSOPermissionSet","INSERT_COMPONENT.new.Properties.InlinePolicy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSSSOPermissionSet.Properties.InlinePolicy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSSSOPermissionSet.Properties.InlinePolicy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSSageMakerModelPackageGroup":{"component":{"type":"Resource","subtype":"AWS::SageMaker::ModelPackageGroup"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSSageMakerModelPackageGroup","INSERT_COMPONENT.new.Properties.ModelPackageGroupPolicy.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSSageMakerModelPackageGroup.Properties.ModelPackageGroupPolicy.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSSageMakerModelPackageGroup.Properties.ModelPackageGroupPolicy.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSServerlessFunction":{"component":{"type":"Resource","subtype":"AWS::Serverless::Function"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSServerlessFunction","INSERT_COMPONENT.new.Properties.AssumeRolePolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSServerlessFunction.Properties.AssumeRolePolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSServerlessFunction.Properties.AssumeRolePolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSECRRegistryPolicy":{"component":{"type":"Resource","subtype":"AWS::ECR::RegistryPolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSECRRegistryPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSECRRegistryPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSECRRegistryPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSEventSchemasRegistryPolicy":{"component":{"type":"Resource","subtype":"AWS::EventSchemas::RegistryPolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSEventSchemasRegistryPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSEventSchemasRegistryPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSEventSchemasRegistryPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSFMSPolicy":{"component":{"type":"Resource","subtype":"AWS::FMS::Policy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSFMSPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSFMSPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSFMSPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSIAMManagedPolicy":{"component":{"type":"Resource","subtype":"AWS::IAM::ManagedPolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMManagedPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMManagedPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSIAMManagedPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSIAMPolicy":{"component":{"type":"Resource","subtype":"AWS::IAM::Policy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIAMPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIAMPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSIAMPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSIoTPolicy":{"component":{"type":"Resource","subtype":"AWS::IoT::Policy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSIoTPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSIoTPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSIoTPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSS3BucketPolicy":{"component":{"type":"Resource","subtype":"AWS::S3::BucketPolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSS3BucketPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSS3BucketPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSS3BucketPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSS3ObjectLambdaAccessPointPolicy":{"component":{"type":"Resource","subtype":"AWS::S3ObjectLambda::AccessPointPolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSS3ObjectLambdaAccessPointPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSS3ObjectLambdaAccessPointPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSS3ObjectLambdaAccessPointPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSS3OutpostsBucketPolicy":{"component":{"type":"Resource","subtype":"AWS::S3Outposts::BucketPolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSS3OutpostsBucketPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSS3OutpostsBucketPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSS3OutpostsBucketPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSSNSTopicPolicy":{"component":{"type":"Resource","subtype":"AWS::SNS::TopicPolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSSNSTopicPolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSSNSTopicPolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSSNSTopicPolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSSQSQueuePolicy":{"component":{"type":"Resource","subtype":"AWS::SQS::QueuePolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSSQSQueuePolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSSQSQueuePolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSSQSQueuePolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]},{"let":{"AWSSecretsManagerResourcePolicy":{"component":{"type":"Resource","subtype":"AWS::SecretsManager::ResourcePolicy"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSSecretsManagerResourcePolicy","INSERT_COMPONENT.new.Properties.PolicyDocument.Statement.*.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["INSERT_PROPERTY appliesTo AWSSecretsManagerResourcePolicy.Properties.PolicyDocument.Statement.*","INSERT_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"INSERT_PROPERTY"}},{"let":{},"where":["UPDATE_PROPERTY appliesTo AWSSecretsManagerResourcePolicy.Properties.PolicyDocument.Statement.*","UPDATE_PROPERTY.new.Effect == 'Allow'"],"effect":{"risk":"high","target":"UPDATE_PROPERTY"}}]}]},{"let":{"ALL_CHANGES":{"change":{}},"INSERT_COMPONENT":{"change":{"type":"INSERT"}}},"then":[{"let":{"AWSEC2SecurityGroup":{"component":{"type":"Resource","subtype":"AWS::EC2::SecurityGroup"}}},"then":[{"let":{},"where":["INSERT_COMPONENT appliesTo AWSEC2SecurityGroup","INSERT_COMPONENT.new.Properties.SecurityGroupIngress.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["ALL_CHANGES appliesTo AWSEC2SecurityGroup.Properties.SecurityGroupIngress.*"],"effect":{"risk":"high","target":"ALL_CHANGES"}},{"let":{},"where":["INSERT_COMPONENT appliesTo AWSEC2SecurityGroup","INSERT_COMPONENT.new.Properties.SecurityGroupEgress.* == '*'"],"effect":{"risk":"high","target":"INSERT_COMPONENT"}},{"let":{},"where":["ALL_CHANGES appliesTo AWSEC2SecurityGroup.Properties.SecurityGroupEgress.*"],"effect":{"risk":"high","target":"ALL_CHANGES"}}]},{"let":{"AWSEC2SecurityGroupIngress":{"component":{"type":"Resource","subtype":"AWS::EC2::SecurityGroupIngress"}}},"then":[{"let":{},"where":["ALL_CHANGES appliesTo AWSEC2SecurityGroupIngress"],"effect":{"risk":"high","target":"ALL_CHANGES"}}]},{"let":{"AWSEC2SecurityGroupEgress":{"component":{"type":"Resource","subtype":"AWS::EC2::SecurityGroupEgress"}}},"then":[{"let":{},"where":["ALL_CHANGES appliesTo AWSEC2SecurityGroupEgress"],"effect":{"risk":"high","target":"ALL_CHANGES"}}]}]}]